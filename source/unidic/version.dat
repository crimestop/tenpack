v1: original
v2: less code
v3: use stack