v2: add direct_sum, add tnary
v3: add kill_D1_ind, add tensors
v4: add tensors, change all to tensors